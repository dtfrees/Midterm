<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dylan Freebairn-Smith">
<meta name="dcterms.date" content="2024-05-08">

<title>Midterm</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="DTFS_Midterm_files/libs/clipboard/clipboard.min.js"></script>
<script src="DTFS_Midterm_files/libs/quarto-html/quarto.js"></script>
<script src="DTFS_Midterm_files/libs/quarto-html/popper.min.js"></script>
<script src="DTFS_Midterm_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="DTFS_Midterm_files/libs/quarto-html/anchor.min.js"></script>
<link href="DTFS_Midterm_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="DTFS_Midterm_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="DTFS_Midterm_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="DTFS_Midterm_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="DTFS_Midterm_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="DTFS_Midterm_files/libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">
<script src="DTFS_Midterm_files/libs/tabwid-1.1.3/tabwid.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Midterm</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Dylan Freebairn-Smith </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 8, 2024</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#load in packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lterdatasampler)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate) <span class="co">#package used to convert date to year and month in separate columns</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="problem-1" class="level1">
<h1><strong>Problem 1</strong></h1>
<ol type="a">
<li>Null Hypothesis (<span class="math inline">\(H_0\)</span>): Phosphorus levels in the soil are equal in recently burned, historically burned, and unburned areas on the reserve.</li>
</ol>
<p>Alternative Hypothesis (<span class="math inline">\(H_A\)</span>): The soil phosphorus levels in the recently burned, historically burned, and unburned areas on the reserve are not all equal.</p>
<ol start="2" type="a">
<li><p>A Single-factor ANOVA test would be a good option because there are more than 2 groups/ levels (recent, historic, unburned) and a single factor/treatment (soil phosphorus levels).</p></li>
<li><p>The three main assumptions for an ANOVA test are independent observations, equal variances for all of the group(recent, historic, unburned) variables, and a normally distributed response variable (soil Phosphorus level).</p></li>
<li><p>Welch’s ANOVA would be a reasonable alternative to the Single-factor ANOVA if the groups did not fulfill the assumption of equal variances and/or if the highest variance was more than 4x the lowest variance. Welch’s ANOVA is very similar to a regular ANOVA, but it does not require equal variances.</p></li>
<li><p>Yes, there could be a difference between the burned and unburned treatments because the means are all different, and the confidence intervals do not overlap.</p></li>
<li><p>We can assume that the figure is normally distributed because the points follow the quantile line. From the results of the Shapiro-Wilkes test, we can be even more sure the data is normally distributed because all of the test statistics are close to 1 (a perfect match with normal distribution) and <span class="math inline">\(p &gt; \alpha\)</span>, so the data is not significantly different from normal distribution and we can continue to use the parametric test.</p></li>
<li><p>The variances are equal enough because the p-value of the Levene test is less than 0.05, and the highest variance is not more than 4x the lowest variance.</p></li>
<li><p>There is a large (<span class="math inline">\(\eta^2 = 0.47\)</span>, CI [0.34,1.00]) difference between soil phosphorus levels between areas with different times since burn (Single-Factor ANOVA, F(2,102) = 4.1822, p-value = 0.018, <span class="math inline">\(\alpha = 0.05\)</span>). There is a significant difference (<span class="math inline">\(\alpha = 0.05\)</span>) between all of the groups. The largest difference in phosphorus levels between types of sites was unburned and recently burned sites (Tukey HSD = -0.357, CI[-0.443, -0.272], P = 0.000) and the smallest difference was between recent burn and historic burn sites (Tukey HSD = 0.162, CI[0.0769, 0.248], P &lt; 0.000).</p></li>
</ol>
</section>
<section id="problem-2" class="level1">
<h1>Problem 2</h1>
<ol type="a">
<li><p>They did the Crab Feeding Trials to test whether crabs consume below-ground roots when presented algae at the same time. They ran Welch’s two-sample t-test to account for the different variance structures between the three trials.</p></li>
<li><p>They had one trial with just pickleweed roots, one with just algae, and one with pickleweed roots and algae but half the amount of each in the previous two trials. Each trial had a control (no-crabs) and a treatment (crabs) and ran for 72 hours.</p></li>
<li><p>The difference in mean dry weights was that if there was a higher mean dry weight that meant that the crabs ate less of the algae or root in that trial. In every trial, the control had a higher mean dry weight than the treatment and this is because in the control there were no crabs introduced to consume the algae or roots, while there were crabs introduced in the treatment.</p></li>
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>CFT_Data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"CFT_Data.csv"</span>) <span class="co">#read in the crab feeding trial data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="5" type="a">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>CFT_Meancrying <span class="ot">&lt;-</span> CFT_Data <span class="sc">%&gt;%</span>  <span class="co"># Create a new df for the means</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Assigned_TTT, Type, Tissue) <span class="sc">%&gt;%</span> <span class="co">#group the data by trial # then by treatment or control, then by tissue type</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Assigned_TTT, Type, Tissue, Post_Trial_Dryweight_g) <span class="sc">%&gt;%</span> <span class="co">#select my relevant columns</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">meanCFT =</span> <span class="fu">mean</span>(Post_Trial_Dryweight_g), <span class="at">.groups =</span> <span class="st">"keep"</span>) <span class="sc">%&gt;%</span> <span class="co">#find the mean of the Post trial dryweight by the predefined groups</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Type, </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> meanCFT) <span class="sc">%&gt;%</span> <span class="co"># Pivot the table to wider so that Type (control and treatment) each have their own columns</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Control_mean =</span> Control, <span class="at">Treatment_mean =</span> Treatment) <span class="co"># rename the columns</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>CFT_SDcrying <span class="ot">&lt;-</span> CFT_Data <span class="sc">%&gt;%</span>  <span class="co"># Create a new df for the means</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Assigned_TTT, Type, Tissue) <span class="sc">%&gt;%</span> <span class="co">#group the data by trial # then by treatment or control, then by tissue type</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Assigned_TTT, Type, Tissue, Post_Trial_Dryweight_g) <span class="sc">%&gt;%</span> <span class="co">#select the relevant columns</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">sdCFT =</span> <span class="fu">sd</span>(Post_Trial_Dryweight_g), <span class="at">.groups =</span> <span class="st">"keep"</span>) <span class="sc">%&gt;%</span>  <span class="co">#find the sd of the Post trial dryweight by the predefined groups</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Type, </span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> sdCFT) <span class="sc">%&gt;%</span> <span class="co"># Pivot the table to wider so that Type (control and treatment) each have their own columns</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Control_sd =</span> Control, <span class="at">Treatment_sd =</span> Treatment)<span class="co"># rename the columns</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>cryingmean_sd <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(CFT_SDcrying, CFT_Meancrying)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cryingmean_sd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 6
# Groups:   Assigned_TTT, Tissue [4]
  Assigned_TTT Tissue        Control_sd Treatment_sd Control_mean Treatment_mean
  &lt;chr&gt;        &lt;chr&gt;              &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;          &lt;dbl&gt;
1 trial (i)    Pickleweed R…     0.0457       0.0710        0.341         0.211 
2 trial (ii)   Algae             0.0351       0.115         0.328         0.118 
3 trial (iii)  Algae             0.105        0.149         0.278         0.0833
4 trial (iii)  Pickleweed R…     0.0328       0.0740        0.326         0.244 </code></pre>
</div>
</div>
<ol start="6" type="a">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### Trial 1</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>ttest_T1 <span class="ot">&lt;-</span> CFT_Data <span class="sc">%&gt;%</span> <span class="co">#create a df for a t-test on trial (i)</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(W.crab_W.O.crab) <span class="sc">%&gt;%</span> <span class="co">#group the columns by treatment/W.crab and control(w.o.crab)</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Assigned_TTT <span class="sc">==</span> <span class="st">"trial (i)"</span>) <span class="sc">%&gt;%</span> <span class="co">#filter to only include trial 1</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Assigned_TTT, W.crab_W.O.crab, Type, Post_Trial_Dryweight_g) <span class="co">#select the necessary columns</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>t_test_result_T1 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(Post_Trial_Dryweight_g <span class="sc">~</span> W.crab_W.O.crab, <span class="co">#assign the test results to an object and run the test on the categorical and value columns</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>                           <span class="at">data =</span> ttest_T1, <span class="co">#use the custom df</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>                           <span class="at">var.equal =</span> <span class="cn">FALSE</span>) <span class="co">#variances are unequal so use a welch's t-test</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t_test_result_T1) <span class="co">#show results</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  Post_Trial_Dryweight_g by W.crab_W.O.crab
t = -5.5502, df = 20.494, p-value = 1.804e-05
alternative hypothesis: true difference in means between group With Crab and group Without Crab is not equal to 0
95 percent confidence interval:
 -0.17878338 -0.08121662
sample estimates:
   mean in group With Crab mean in group Without Crab 
                 0.2107692                  0.3407692 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### Trial 2</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>ttest_T2 <span class="ot">&lt;-</span> CFT_Data <span class="sc">%&gt;%</span> <span class="co">#create a df for a t-test on trial (ii)</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(W.crab_W.O.crab) <span class="sc">%&gt;%</span> <span class="co">#group the columns by treatment/W.crab and control(w.o.crab)</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Assigned_TTT <span class="sc">==</span> <span class="st">"trial (ii)"</span>) <span class="sc">%&gt;%</span>  <span class="co">#filter to only include trial 2</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Assigned_TTT, W.crab_W.O.crab, Type, Post_Trial_Dryweight_g) <span class="co">#select the necessary columns</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>t_test_result_T2 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(Post_Trial_Dryweight_g <span class="sc">~</span> W.crab_W.O.crab, <span class="co">#assign the test results to an object and run the test on the categorical and value columns</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>                           <span class="at">data =</span> ttest_T2, <span class="co">#assign custom df</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>                           <span class="at">var.equal =</span> <span class="cn">FALSE</span>)<span class="co">#variances are unequal so use a welch's t-test</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t_test_result_T2) <span class="co">#show reults</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  Post_Trial_Dryweight_g by W.crab_W.O.crab
t = -6.098, df = 13.051, p-value = 3.729e-05
alternative hypothesis: true difference in means between group With Crab and group Without Crab is not equal to 0
95 percent confidence interval:
 -0.2854970 -0.1361696
sample estimates:
   mean in group With Crab mean in group Without Crab 
                 0.1175000                  0.3283333 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### Trial 3 Pickleweed</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>ttest_PWT3 <span class="ot">&lt;-</span> CFT_Data <span class="sc">%&gt;%</span> <span class="co">#create a df for a t-test on trial (iii) w/ pickleweed root</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Assigned_TTT_old, Assigned_TTT, Type, Planned_Starting_FW_g, Post_Trial_Dryweight_g, Tissue, W.crab_W.O.crab) <span class="sc">%&gt;%</span> <span class="co">#select the necessary columns</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Assigned_TTT) <span class="sc">%&gt;%</span> <span class="co">#group the columns by treatment and control</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Assigned_TTT <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"trial (iii)"</span>) <span class="sc">&amp;</span> Tissue <span class="sc">==</span> <span class="st">"Pickleweed Roots"</span>) <span class="co">#filter to only include trial 3 and pickleweed root in the Tissue column</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>t_test_result_PWT3 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(Post_Trial_Dryweight_g <span class="sc">~</span> W.crab_W.O.crab, <span class="co">#assign the test results to an object and run the test on the categorical and value columns</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>                           <span class="at">data =</span> ttest_PWT3, <span class="co">#assign custom df</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>                           <span class="at">var.equal =</span> <span class="cn">FALSE</span>) <span class="co">#variances are unequal so use a welch's t-test</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t_test_result_PWT3) <span class="co">#show results</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  Post_Trial_Dryweight_g by W.crab_W.O.crab
t = -3.0054, df = 11.031, p-value = 0.01193
alternative hypothesis: true difference in means between group With Crab and group Without Crab is not equal to 0
95 percent confidence interval:
 -0.14049285 -0.02172937
sample estimates:
   mean in group With Crab mean in group Without Crab 
                 0.2444444                  0.3255556 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### Trial 3 Algae</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>ttest_ALT3 <span class="ot">&lt;-</span> CFT_Data <span class="sc">%&gt;%</span> <span class="co">#create a df for a t-test on trial (iii) w/ Algae</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Assigned_TTT_old, Assigned_TTT, Type, Planned_Starting_FW_g, Post_Trial_Dryweight_g, Tissue, W.crab_W.O.crab) <span class="sc">%&gt;%</span> <span class="co">#select the necessary columns</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Assigned_TTT) <span class="sc">%&gt;%</span> <span class="co">#group the columns by treatment and control</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Assigned_TTT <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"trial (iii)"</span>) <span class="sc">&amp;</span> Tissue <span class="sc">==</span> <span class="st">"Algae"</span>) <span class="co">#filter to only include trial 3 and algae in the Tissue column</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>t_test_result_ALT3 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(Post_Trial_Dryweight_g <span class="sc">~</span> W.crab_W.O.crab, <span class="co">#assign the test results to an object and run the test on the categorical and value columns</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>                           <span class="at">data =</span> ttest_ALT3, <span class="co">#assign custom df</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>                           <span class="at">var.equal =</span> <span class="cn">FALSE</span>)<span class="co"># variances are unequal so use a welch's t-test</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t_test_result_ALT3) <span class="co">#show results</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  Post_Trial_Dryweight_g by W.crab_W.O.crab
t = -3.2041, df = 14.398, p-value = 0.006177
alternative hypothesis: true difference in means between group With Crab and group Without Crab is not equal to 0
95 percent confidence interval:
 -0.32426486 -0.06462403
sample estimates:
   mean in group With Crab mean in group Without Crab 
                0.08333333                 0.27777778 </code></pre>
</div>
</div>
<ol start="7" type="a">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> CFT_Data, <span class="co">#use original dataframe</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> Type, <span class="co">#x-axis is the dryweight of algae or pickleweed left</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">y =</span> Post_Trial_Dryweight_g, <span class="co"># y is the type of experiment it was control or treatment (normally on the x but for a horizontal jitter this is required)</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> Tissue)) <span class="sc">+</span> <span class="co"># classify the colors of th data according</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="co"># change the width of the horizontal jitter</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">height =</span> <span class="dv">0</span>, <span class="co"># make the height of the horizontal jitter 0</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span> <span class="co"># make the underlying data transparent</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">"pointrange"</span>, <span class="co"># make the </span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">fun.data =</span> mean_se, <span class="co"># display the mean and the standard error of the data in the pointrange</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="co">#make the mean point larger to differentiate from the underlying data</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> Assigned_TTT <span class="sc">+</span> Tissue) <span class="sc">+</span> <span class="co"># create separate plots for each trial and each Tissue type </span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">"none"</span>) <span class="sc">+</span> <span class="co"># lake out the legend for the "color = Tissue" in the ggplot(aes())</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="co"># choose a theme without gridlines</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"darkgreen"</span>, <span class="st">"cornflowerblue"</span>))  <span class="sc">+</span> <span class="co"># change the colors of the Tissue</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Post-Trial Mean Dryweight (g)</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="st">       +/- Std. Error"</span>,<span class="co"># add an x-axis title</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">""</span>)  <span class="co"># take out the y-axis title because we only need the tick marks to explain it</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DTFS_Midterm_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ol start="8" type="a">
<li>Fig. 1: Laboratory Crab Feeding Trial Results: Showing mean amounts (Highlighted dots) of Dryweight Pickleweed (S. Pacifica) Root or Algae (Ulva Lactuca) left after being a jar for 72 hours Without Crab (Control) vs.&nbsp;With Crab (Treatment) (<span class="math inline">\(\pm\)</span> SEM (whiskers)). The transparent points underneath the Mean and SE are the underlying data points from observation within the trial. Green represents the Algae and blue represents Pickleweed roots. In trial (iii) both Pickleweed roots and algae were put in the jar. Data citation: Beheshti, Kathryn (2022). Long-term study reveals top-down effect of crabs on a California salt marsh [Dataset]. Dryad. https://doi.org/10.7291/D1H971</li>
</ol>
</section>
<section id="problem-3" class="level1">
<h1>Problem 3</h1>
<ol type="a">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>arc_weather <span class="ot">&lt;-</span> arc_weather <span class="co"># assign the dataset from lterdatasampler package ot a dataframe</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>arc_weather_clean <span class="ot">&lt;-</span> arc_weather <span class="sc">%&gt;%</span>  <span class="co">#create a clean dataframe to plot the desired data</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">year</span>(date), <span class="co"># create a anew column by extracting the year from the date column</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">month_name =</span> <span class="fu">month</span>(date,  <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">abbr =</span> <span class="cn">FALSE</span>)) <span class="sc">%&gt;%</span>  <span class="co">#create a new column by extracting the month from the date column and making sure that it isnt abbreviated by using the "label = TRUE and abbr = FALSE" arguments</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(year, month_name, mean_airtemp) <span class="sc">%&gt;%</span> <span class="co">#select the columns we want to plot</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, month_name) <span class="sc">%&gt;%</span> <span class="co">#group the rows by year and then by month name so summarise() works</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_monthly_airtemp =</span> <span class="fu">mean</span>(mean_airtemp)) <span class="sc">%&gt;%</span> <span class="co"># Summarize the mean daily air temp into a column with the mean air temp each group of months within a each year</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">month =</span> month_name) <span class="co">#change the "month_name" column name to "month"</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(arc_weather_clean, <span class="dv">10</span>) <span class="co">#display the first ten rows of the cleaned table</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 3
# Groups:   year [2]
    year month     mean_monthly_airtemp
   &lt;dbl&gt; &lt;ord&gt;                    &lt;dbl&gt;
 1  1988 June                      9.61
 2  1988 July                     12.0 
 3  1988 August                    6.96
 4  1988 September                -0.26
 5  1988 October                 -16.4 
 6  1988 November                -29.2 
 7  1988 December                -17.1 
 8  1989 January                 -29.9 
 9  1989 February                 -8.06
10  1989 March                   -19.4 </code></pre>
</div>
</div>
<ol start="2" type="a">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(arc_weather_clean, <span class="co">#use the cleaned data set</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> month, <span class="co"># put the month on the x-axis</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> mean_monthly_airtemp, <span class="co"># put the mean monthly air temp on the y axis (multiple values are associated with each month name)</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">group =</span> year, <span class="co"># group the points by year to connect the mean monthly air temps of each different year</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> year)) <span class="sc">+</span> <span class="co"># assign colors by year</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="co"># add a line for each year connected my the mean monthly air temps</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="co"># add a line at y = 0</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span> <span class="co"># make the line dashed</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradient</span>(<span class="at">high =</span> <span class="st">"#55B0F4"</span>, <span class="co"># choose a color for the low end of the gradient for the legend</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">low =</span> <span class="st">"#142D46"</span>, <span class="co"># choose a high end color for the legend gradient</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">name =</span> <span class="st">"Year"</span>) <span class="sc">+</span> <span class="co"># name the legend "Year"</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span> <span class="co"># change the theme to light</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"grey"</span>), <span class="co"># change the plot panel borders to be grey</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(), <span class="co"># take out the gridlines</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>), <span class="co"># change the size of the tick mark labels</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>), <span class="co"># change the size of the axis label font</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>)) <span class="sc">+</span> <span class="co"># change the title font size</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Toolik field station is above freezing between May and September"</span>, <span class="co"># title the plot</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(Mean<span class="sc">~</span>Monthly<span class="sc">~</span>Air<span class="sc">~</span>Temperature<span class="sc">~</span><span class="st">"("</span><span class="sc">*</span>degree<span class="sc">*</span>C<span class="sc">~</span><span class="st">")"</span>), <span class="co"># name the y axis but include the degree symbol in Celcius</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Month"</span>) <span class="co"># name the x axis</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DTFS_Midterm_files/figure-html/Problem%203b-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="problem-4" class="level1">
<h1>Problem 4</h1>
<ol type="a">
<li><p>My response variable is the amount of time I spend in the water during a cold plunge and the predictor variable I am using is the weather on each day of the plunge. I will be looking at the mean amount of time I spend in the water when it is Fair, Cloudy, and Misty weather.</p></li>
<li><p>&amp; c.</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>Cold_Plunge <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Cold_Plunge.csv"</span>) <span class="co"># read in my csv sheet</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>Cold_Plunge_Clean <span class="ot">&lt;-</span> Cold_Plunge <span class="sc">%&gt;%</span> <span class="co">#assign the cleaned df to a new object</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">`</span><span class="at">Water_Time (s)</span><span class="st">`</span>, Weather) <span class="sc">%&gt;%</span>  <span class="co"># select the columns I want to analyze</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> <span class="co">#clean the names of the columns</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(weather) <span class="co"># group the columns by weather type</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>Cold_Plunge_WTbW_Mean <span class="ot">&lt;-</span> Cold_Plunge_Clean <span class="sc">%&gt;%</span> <span class="co"># create a dataframe with the means by different weather type</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(water_time_s)) <span class="sc">%&gt;%</span> <span class="co"># find the mean of water time by the grouped weatehr types</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Weather =</span> weather) <span class="sc">%&gt;%</span>  <span class="co"># rename the column</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">Mean Water Time (s)</span><span class="st">`</span> <span class="ot">=</span> mean)  <span class="co"># rename the column</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Cold_Plunge_Clean, <span class="co"># plot the initial clean df</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> weather, <span class="co"># plot the weather type on the x axis</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> water_time_s, <span class="co"># plot the water time on the y axis</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> weather)) <span class="sc">+</span> <span class="co"># color the data by weather type</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> .<span class="dv">1</span>, <span class="co"># create a jitter plot</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="co"># make the underlying data transparent</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="co"># create a error bar showing the confidence interval of the mean for water time by weather type</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">fun.data =</span> mean_cl_normal) <span class="sc">+</span> <span class="co"># find the the CI</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> Cold_Plunge_WTbW_Mean, <span class="co"># use the mean summary table i created</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> Weather, <span class="co">#nweather type on the x</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> <span class="st">`</span><span class="at">Mean Water Time (s)</span><span class="st">`</span>, <span class="co"># water time on the y</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> Weather), <span class="co"># color the points by weather type</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="co"># change the size of the points</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">120</span>, <span class="dv">180</span>, <span class="dv">240</span>, <span class="dv">300</span>), <span class="co"># add a line at y =  60, 120, 180, 240, 300</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>,<span class="co"># make the lines dashed</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span>  <span class="co"># make the lines transparent </span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>( <span class="at">fill =</span> <span class="st">"#FFFFFC"</span>, <span class="co"># change the background color of the grid to increase </span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">color =</span> <span class="st">"black"</span>, <span class="co"># change the panel outline color</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">linewidth =</span> <span class="fl">0.5</span>), <span class="co"># change the linewidth of the panel outline </span></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="co"># take out the major grid lines</span></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span> <span class="co"># take out the minor gridlines</span></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">300</span>) <span class="sc">+</span> <span class="co"># set the limits on the y axis</span></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Time spent cold plunging during</span></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a><span class="st">       different weather conditions"</span>, <span class="co"># Add title</span></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"by: dylan freebairn-smith"</span>, <span class="co"># Add a subtitle</span></span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Water Time (s)"</span>, <span class="co">#Add a y axis label</span></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Weather"</span>, <span class="co">#Add a x axis label</span></span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> </span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a><span class="st">"Fig 1: Time spent cold plunging during different weather conditions: </span></span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a><span class="st">All data points are graphed with the mean time  spent in water for </span></span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a><span class="st">each weather type as the larger data pointand an error bar showing </span></span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a><span class="st">the 95% confidence interval for each weather type.  There is no error</span></span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a><span class="st">bar for Mist because there isn't enough data. The data points under-</span></span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a><span class="st">neath the mean and CI are the underlying data/ individual observations.</span></span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a><span class="st">The dashed lines represent 60 second intervals at 1, 2, 3, and 4 minute intervals."</span>, <span class="co"># add a caption</span></span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Mean Water Time"</span>) <span class="co"># Change the legend title</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DTFS_Midterm_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ol start="4" type="a">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set_flextable_defaults</span>() <span class="co"># set the default settings for the flextable</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>ft <span class="ot">&lt;-</span> <span class="fu">flextable</span>(Cold_Plunge_WTbW_Mean) <span class="co">#assign the mean water time table to the flex table </span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>ft <span class="ot">&lt;-</span><span class="fu">set_caption</span>(ft, <span class="at">caption =</span> <span class="st">"Mean Seconds in Water by Weather Type"</span>)  <span class="co"># create a caption/title for the flextable</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>ft <span class="co"># show the flextable</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="tabwid"><style>.cl-c86a7102{}.cl-c861fb12{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-c865f50a{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-c865f51e{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-c8660a7c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c8660a86{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c8660a87{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c8660a90{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c8660a91{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c8660a9a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-c86a7102"><thead><tr style="overflow-wrap:break-word;"><th class="cl-c8660a7c"><p class="cl-c865f50a"><span class="cl-c861fb12">Weather</span></p></th><th class="cl-c8660a86"><p class="cl-c865f51e"><span class="cl-c861fb12">Mean Water Time (s)</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-c8660a87"><p class="cl-c865f50a"><span class="cl-c861fb12">Cloudy</span></p></td><td class="cl-c8660a90"><p class="cl-c865f51e"><span class="cl-c861fb12">105.25000</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c8660a87"><p class="cl-c865f50a"><span class="cl-c861fb12">Fair</span></p></td><td class="cl-c8660a90"><p class="cl-c865f51e"><span class="cl-c861fb12">95.72727</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c8660a91"><p class="cl-c865f50a"><span class="cl-c861fb12">Mist</span></p></td><td class="cl-c8660a9a"><p class="cl-c865f51e"><span class="cl-c861fb12">180.00000</span></p></td></tr></tbody></table></div>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>